[![CI](https://github.com/atomless/Shuma-Gorath/actions/workflows/ci.yml/badge.svg?branch=main)](https://github.com/atomless/Shuma-Gorath/actions/workflows/ci.yml)
[![Dashboard E2E](https://github.com/atomless/Shuma-Gorath/actions/workflows/dashboard-e2e.yml/badge.svg?branch=main)](https://github.com/atomless/Shuma-Gorath/actions/workflows/dashboard-e2e.yml)

![Shuma-Gorath](dashboard/assets/shuma-gorath.png)

# üêô Shuma-Gorath

Chaos Dimension Bot Defence for Spin. Shuma-Gorath is a WebAssembly bot defence that detects, blocks, and monitors automated abuse with honeypots, rate limiting, JS challenges, CDP signals, a maze, and a real-time admin dashboard.

Shuma-Gorath is designed to **complement enterprise bot defenses** (such as [Akamai Bot Manager](https://www.akamai.com/products/bot-manager_) as a second-layer of application-specific protection, but it can also run standalone.

## üêô Quickstart (Official)

```bash
# One-time setup (installs Rust, Spin, cargo-watch)
make setup

# Show the local dashboard login key generated by setup
make api-key-show

# If commands are missing, open a new terminal or run:
# source ~/.zshrc

# Start the dev server (official path)
make dev
```

Dashboard:
- `http://127.0.0.1:3000/dashboard/index.html`

Notes:
- Run setup in an interactive terminal (it may prompt for sudo to install Spin).
- `make setup` creates `.env.local` (gitignored) and auto-generates local dev secrets.
- Use the Makefile for all build/run/test flows.

## üêô Common Commands

```bash
make dev              # Start dev server with file watching
make test             # Unit tests + integration if server running
make test-unit        # Unit tests only
make test-integration # Integration tests (requires running server)
make stop             # Stop Spin server
make status           # Check server status
make api-key-show     # Show local dashboard login key from .env.local
make help             # Show all commands
```

## üêô Configuration

- Full, canonical variable reference (env-only keys + KV tunables): `docs/configuration.md`
- Env-only deployment template: `/.env.full.example`
- Canonical defaults (seeded into KV): `config/defaults.env`
- Supported env-only overrides helper: `make env-help`

Deployment policy note: `SHUMA_KV_STORE_FAIL_OPEN` is a critical choice (fail-open vs fail-closed) when the KV store is unavailable. See `docs/security-hardening.md` and `docs/deployment.md`.

## üêô Documentation

- [`docs/index.md`](docs/index.md) - Docs index
- [`docs/quick-reference.md`](docs/quick-reference.md) - Command and API cheat sheet
- [`docs/testing.md`](docs/testing.md) - Testing guide (Makefile-only)
- [`docs/dashboard.md`](docs/dashboard.md) - Dashboard and admin UI
- [`docs/deployment.md`](docs/deployment.md) - Production/deploy configuration
- [`docs/api.md`](docs/api.md) - API usage and endpoint details
- [`docs/configuration.md`](docs/configuration.md) - Runtime configuration reference
- [`docs/security-hardening.md`](docs/security-hardening.md) - Deployment security checklist
- [`docs/observability.md`](docs/observability.md) - Prometheus/Grafana integration
- [`docs/akamai-bot-manager.md`](docs/akamai-bot-manager.md) - Positioning and layered defense
- [`docs/features.md`](docs/features.md) - Feature list and roadmap
- [`docs/challenge-verification.md`](docs/challenge-verification.md) - Human verification strategy
- [`docs/maze.md`](docs/maze.md) - maze crawler trap
- [`todos/security-review.md`](todos/security-review.md) - Security audit notes / backlog

## üêô Repository Structure (High Level)

```
src/        # Core bot defence logic (Spin component)
dashboard/  # Admin dashboard UI
scripts/    # Build helpers (Makefile used by default)
```
